function out = PredPrey_2d
out{1} = @init;
out{2} = @fun_eval;
out{3} = @jacobian;
out{4} = @jacobian_params;
out{5} = @hessians;
out{6} = @hessians_params;
out{7} = @third_order_derivatives;
out{8} = [];
out{9} = [];
out{10} = [];% usernorm DV: this is the only difference between
% the standard matcont problem file and the cl_matcontL problem file
out{11}= @x1;
out{12}= @x2;
out{13}= @x3;
out{14}= @x4;
out{15}= @x5;

% Suppress function might not be used warning in this file:
%#ok<*DEFNU>
% Suppress Input argument might be unused warnings in this file: 
%#ok<*INUSD>
%#ok<*INUSL>

% --------------------------------------------------------------------------
function dydt = fun_eval(t,y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
i_RFZA = par_a_ZA * y(1)/(1 + par_a_ZA * 4.5 * y(1));
i_RFPA = 0.5 * y(1)^2/(1 + 0.5 * 0.5 * y(1)^2);
i_RFPZ = par_a_PZ * y(2)^2/(1 + par_a_PZ * 20 * y(2)^2);
i_RFFA = 0.05 * y(1)^2/(1 + 0.05 * 1 * y(1)^2);
dydt =[
  1.5 * y(1) * (1 - y(1)/10.8) - i_RFZA * y(2) - i_RFPA * par_P - i_RFFA * 0.0005;
  1 * i_RFZA * y(2) - par_m_Z * y(2) - i_RFPZ * par_P];
% --------------------------------------------------------------------------
function options = init()
handles = feval(PredPrey_2d);
options = odeset(...
  'Jacobian', handles(3), 'JacobianP', handles(4), ...
  'Hessians', handles(5), 'HessiansP', handles(6));

% --------------------------------------------------------------------------
function jac = jacobian(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
jac = reshape([y(1).*(-5.0./1.8e+1)+y(1).^3.*1.0./(y(1).^2.*2.0e+3+4.0e+4).^2.*4.0e+3-(y(1).*2.0)./(y(1).^2.*2.0e+3+4.0e+4)-(par_P.*y(1).*2.0)./(y(1).^2./2.0+2.0)-(par_a_ZA.*y(2))./(par_a_ZA.*y(1).*(9.0./2.0)+1.0)+par_P.*y(1).^3.*1.0./(y(1).^2./2.0+2.0).^2+par_a_ZA.^2.*y(1).*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*(9.0./2.0)+3.0./2.0,(par_a_ZA.*y(2))./(par_a_ZA.*y(1).*(9.0./2.0)+1.0)-par_a_ZA.^2.*y(1).*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*(9.0./2.0),-(par_a_ZA.*y(1))./(par_a_ZA.*y(1).*(9.0./2.0)+1.0),-par_m_Z+(par_a_ZA.*y(1))./(par_a_ZA.*y(1).*(9.0./2.0)+1.0)-(par_P.*par_a_PZ.*y(2).*2.0)./(par_a_PZ.*y(2).^2.*2.0e+1+1.0)+par_P.*par_a_PZ.^2.*y(2).^3.*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^2.*4.0e+1],[2,2]);
% --------------------------------------------------------------------------
function jacp=jacobian_params(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
jacp = reshape([-(y(1).*y(2))./(par_a_ZA.*y(1).*(9.0./2.0)+1.0)+par_a_ZA.*y(1).^2.*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*(9.0./2.0),(y(1).*y(2))./(par_a_ZA.*y(1).*(9.0./2.0)+1.0)-par_a_ZA.*y(1).^2.*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*(9.0./2.0),0.0,-(par_P.*y(2).^2)./(par_a_PZ.*y(2).^2.*2.0e+1+1.0)+par_P.*par_a_PZ.*y(2).^4.*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^2.*2.0e+1,0.0,-y(2),-y(1).^2./(y(1).^2./2.0+2.0),-(par_a_PZ.*y(2).^2)./(par_a_PZ.*y(2).^2.*2.0e+1+1.0)],[2,4]);
% --------------------------------------------------------------------------
function hess = hessians(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
hess = reshape([y(1).^2.*1.0./(y(1).^2.*2.0e+3+4.0e+4).^2.*2.0e+4-y(1).^4.*1.0./(y(1).^2.*2.0e+3+4.0e+4).^3.*3.2e+7-(par_P.*2.0)./(y(1).^2./2.0+2.0)-2.0./(y(1).^2.*2.0e+3+4.0e+4)+par_P.*y(1).^2.*1.0./(y(1).^2./2.0+2.0).^2.*5.0-par_P.*y(1).^4.*1.0./(y(1).^2./2.0+2.0).^3.*2.0+par_a_ZA.^2.*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*9.0-par_a_ZA.^3.*y(1).*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(8.1e+1./2.0)-5.0./1.8e+1,par_a_ZA.^2.*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*-9.0+par_a_ZA.^3.*y(1).*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(8.1e+1./2.0),-par_a_ZA./(par_a_ZA.*y(1).*(9.0./2.0)+1.0)+par_a_ZA.^2.*y(1).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*(9.0./2.0),par_a_ZA./(par_a_ZA.*y(1).*(9.0./2.0)+1.0)-par_a_ZA.^2.*y(1).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*(9.0./2.0),-par_a_ZA./(par_a_ZA.*y(1).*(9.0./2.0)+1.0)+par_a_ZA.^2.*y(1).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*(9.0./2.0),par_a_ZA./(par_a_ZA.*y(1).*(9.0./2.0)+1.0)-par_a_ZA.^2.*y(1).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*(9.0./2.0),0.0,(par_P.*par_a_PZ.*-2.0)./(par_a_PZ.*y(2).^2.*2.0e+1+1.0)+par_P.*par_a_PZ.^2.*y(2).^2.*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^2.*2.0e+2-par_P.*par_a_PZ.^3.*y(2).^4.*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^3.*3.2e+3],[2,2,2]);
% --------------------------------------------------------------------------
function hessp = hessians_params(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
hessp = reshape([y(1).^2.*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*9.0-par_a_ZA.*y(1).^3.*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(8.1e+1./2.0),y(1).^2.*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*-9.0+par_a_ZA.*y(1).^3.*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(8.1e+1./2.0),0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,par_P.*y(2).^4.*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^2.*4.0e+1-par_P.*par_a_PZ.*y(2).^6.*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^3.*8.0e+2,0.0,0.0,0.0,-y(2).^2./(par_a_PZ.*y(2).^2.*2.0e+1+1.0)+par_a_PZ.*y(2).^4.*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^2.*2.0e+1,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,-y(2).^2./(par_a_PZ.*y(2).^2.*2.0e+1+1.0)+par_a_PZ.*y(2).^4.*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^2.*2.0e+1,0.0,0.0,0.0,0.0],[2,4,4]);
%---------------------------------------------------------------------------
function d = third_order_derivatives(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
d = reshape([y(1).^3.*1.0./(y(1).^2.*2.0e+3+4.0e+4).^3.*-2.88e+8+y(1).^5.*1.0./(y(1).^2.*2.0e+3+4.0e+4).^4.*3.84e+11+y(1).*1.0./(y(1).^2.*2.0e+3+4.0e+4).^2.*4.8e+4+par_P.*y(1).*1.0./(y(1).^2./2.0+2.0).^2.*1.2e+1-par_P.*y(1).^3.*1.0./(y(1).^2./2.0+2.0).^3.*1.8e+1+par_P.*y(1).^5.*1.0./(y(1).^2./2.0+2.0).^4.*6.0-par_a_ZA.^3.*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(2.43e+2./2.0)+par_a_ZA.^4.*y(1).*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^4.*5.4675e+2,par_a_ZA.^3.*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(2.43e+2./2.0)-par_a_ZA.^4.*y(1).*y(2).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^4.*5.4675e+2,par_a_ZA.^2.*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*9.0-par_a_ZA.^3.*y(1).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(8.1e+1./2.0),par_a_ZA.^2.*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*-9.0+par_a_ZA.^3.*y(1).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(8.1e+1./2.0),par_a_ZA.^2.*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*9.0-par_a_ZA.^3.*y(1).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(8.1e+1./2.0),par_a_ZA.^2.*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*-9.0+par_a_ZA.^3.*y(1).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(8.1e+1./2.0),0.0,0.0,par_a_ZA.^2.*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*9.0-par_a_ZA.^3.*y(1).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(8.1e+1./2.0),par_a_ZA.^2.*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^2.*-9.0+par_a_ZA.^3.*y(1).*1.0./(par_a_ZA.*y(1).*(9.0./2.0)+1.0).^3.*(8.1e+1./2.0),0.0,0.0,0.0,0.0,0.0,par_P.*par_a_PZ.^2.*y(2).*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^2.*4.8e+2-par_P.*par_a_PZ.^3.*y(2).^3.*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^3.*2.88e+4+par_P.*par_a_PZ.^4.*y(2).^5.*1.0./(par_a_PZ.*y(2).^2.*2.0e+1+1.0).^4.*3.84e+5],[2,2,2,2]);
%---------------------------------------------------------------------------
function d = fourth_order_derivatives(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
d = [];
%---------------------------------------------------------------------------
function d = fifth_order_derivatives(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
d = [];

function userfun1=x1(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
	userfun1=0;
function userfun2=x2(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
	userfun2=0;
function userfun3=x3(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
	userfun3=0;
function userfun4=x4(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
	userfun4=0;
function userfun5=x5(t, y, par_a_ZA, par_a_PZ, par_m_Z, par_P)
	userfun5=0;
