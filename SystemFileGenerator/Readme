 
== Documentation for the System File Generator ==

The class SystemFileGenerator can be used to process a system of equations so that it can be analyzed with cl_matcontL. The output of SystemFileGenerator is a matcont system file, and optionally a mex file. SystemFileGenerator generates one or more file that decribe a system of differential equations of the form:

dx/dt = f(t,x,a)

where f is a function from R^n to R^n and where n is the length of x

- the components (x_1, x_2, ... ) of x are specified by specifying the equations that define the derivatives w.r.t. time of x_1, x_2, ... .

To generate a matcont system file, start the GUI with the command.

SystemsGUI.new
  
or if you want the use the command line interface execute the commands:

s = System_of_ODEs.new(<name>, <parameters_str>, <time>, <max_order_derivatives>, <equations>)
s.generate_file

or 

s = System_of_ODEs.new(<name>, <parameters_str>, <time>, <max_order_derivatives>, ...
					   <equations>,<output_type>)
s.generate_file

 
with:

<name>: a char array or string containing a filename for the generated system
 
<parameters_str>: a char array or string containing the names of the parameters of the system of the ODEs, separated by any number of spaces and/or commas.

<time>: a char array or string containing the name of the variable that represents time
 
<max_order_derivatives>: the maximum order of derivatives for which code is generated that evaluates the derivatives.
 
<equations>: a 1d cell array of character vectors and/or strings, or an array of strings, containing at least 1 differential equation and optionally partial expressions. for example:
  
 f = x + y  (optional partial expression)
 x' = f * y (differential equation)
 y' = f * x (differential equation)

<output_type>: must be one of 'odefile', 'C', or 'cvode'; 

where <name> is the name of the system, which will be used for the filename. The matcont file generated represents the first order system of ODEs.

== Using CVODES with cl_matconL ==

System_of_ODEs can also generate a C program that can do time integration of the system using CVODES in the form of a mex file. Using the CVODES time integrator improves speed by a factor of four (approximately). This mexfile-C-program can be generated by passing the char array 'cvode' as the optional sixth argument to SystemFileGenerator.new.

The CVODES integrates also performs the sensitivity analysis needed to compute the monodromy matrix in cycle continuation using the shooting methods.

== Technical details of mex interface of CVODES integrator ==

System_of_ODEs can be used to generate a CVODES integrator program for a specific system of ODEs. System_of_ODEs generates c-code for the right hand side of the System of ODEs, the Jacobian matrix of the system of ODEs, and the right hand side of the system of ODEs that is used to compute the sensitivity.

== Advantage of generating C functions that define the system of ODEs ==

By generating the C-code instead of linking CVODES to matlab functions that define the system of ODEs saves a lot of costly overhead. This is because all Matlab versions up to version 2019a almost always need to allocate new memory every time a result is returned. Hence, every time the right hand side of the system is evaluated, new memory is allocated. In C we can reuse memory. Thus using functions written in C, we can significantly reduce the number of memory allocations.


Note that cl_matcontL was tested only on matlab 2019a